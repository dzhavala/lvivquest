(function () {    var $map_canvas = $('#map_canvas'),    map,    locationsArr = [      {        name: 'Фонтан з Нептуном',        coords: '49.841401,24.031141',        isMarked: true      },      {        name: 'Фонтан з Діаною',        coords: '49.841667,24.032437',        isMarked: false      },      {        name: 'Фонтан з Адонісом',        coords: '49.842331,24.032093',        isMarked: false      },      {        name: 'Фонтан з Амфітридою',        coords: '49.842068,24.030803',        isMarked: false      },      {        name: 'Endpoint',        coords: '49.81675,23.998000',        isMarked: true      }          ];    var destinationPoint = locationsArr[0],        userData = {          location: undefined        };     // Init map then dom is loaded and map canvas is visible (it is hidden on mobile devices)  google.maps.event.addDomListener(window, 'load', function(){      Map.setArrLocations(locationsArr);      map = Map.initialize();      registerMapEventHandlers();      UserLocation.listenForUserPosition(getPositionSuccess, getPositionError);      $('#checkin-btn').on('click', function(e){        // UserLocation.getPosition().done(function(userLocation) {        //   userData.location = userLocation;        //   console.log(userLocation);           Map.showUserLocation(userData.location);           var inOnPlaceFlag = isOnPlace();           console.log('Is on place ', isOnPlaceFlag);        // })        // .fail(function(err) {        //   console.log( "failed! ", err );        // });      });  });  function getPositionSuccess(userLocation){    userData.location = userLocation;    console.log(userLocation);    Map.showUserLocation(userLocation);  }  function getPositionError(err){    console.log( "failed! ", err );  }  function isOnPlace() {    var parts = destinationPoint.coords.split(',');        destinationPoint.location = new google.maps.LatLng(parts[0], parts[1]),        distance = Map.measureUserDistance(userData.location, destinationPoint.location);    return distance <= markerRadiusOptions.radius;  }  // Then triggered click event on map marker, then update DOM elements  function registerMapEventHandlers() {    google.maps.event.addListener(map, "markerActivated", function(locationObj) {      console.log('Event comes from from map: ', locationObj);    });  }}());